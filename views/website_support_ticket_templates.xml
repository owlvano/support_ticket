<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data>
  
  <template id="assets_frontend" inherit_id="web.assets_frontend" name="website support ticket frontend assets">
      <xpath expr="." position="inside">
        <link href="/support_ticket/static/src/fancygrid/fancy.min.css" rel="stylesheet"/>
        <script src="/support_ticket/static/src/fancygrid/fancy.min.js"></script>
        <script>Fancy.MODULESDIR = '/support_ticket/static/src/fancygrid/modules/';</script>
      </xpath>
  </template>

  <template id="website_support.support_ticket_view_list" name="My Support Tickets" page="True">
    <t t-call="website.layout">
        <div class="container">

          <div class="mt16 mb16">
            <h1 class="text-center">My Support Tickets</h1>
          </div>
      
          <div class="col-md-3"></div>

          <script>

            $(document).ready(function() {

              function load_support_tickets() {
                var tickets = new Array();

                <t t-foreach="support_tickets" t-as="support_ticket">                
                  tickets.push({
                    personName: "<t t-raw="support_ticket.person_name"/>", 
                    subject: "<t t-esc="support_ticket.subject"/>",
                    category: "<t t-esc="support_ticket.category.name"/>",
                    state: "<t t-esc="support_ticket.state.name"/>",
                    createDate: "<t t-esc="support_ticket.create_date"/>"                  
                  });
                </t>

                return tickets;
              }


              $('#ticketgrid').FancyGrid({    
                width: 500,
                height: 400,
                data: load_support_tickets(),
                columns: [{
                  index: 'personName',      
                  title: 'Person Name',
                  type: 'string',
                  width: 100
                },{
                  index: 'subject',
                  title: 'Subject',
                  type: 'string',
                  width: 100
                },{
                  index: 'category',
                  title: 'Category',
                  type: 'string',
                  width: 100
                },{
                  index: 'state',
                  title: 'State',
                  type: 'string',
                  width: 100
                },{
                  index: 'createDate',
                  title: 'Create Date',
                  type: 'date',
                  width: 100,
                  format: {
                    read: 'Y-m-d H:i:s',
                    write: 'Y-m-d H:i:s'
                  }
                }]
              });

            });

          </script>

          <div class="col-md-6">
              <t t-if="ticket_count > 0"> 
                <div id="ticketgrid"></div>
              </t>
              <t t-if="ticket_count == 0">
                <div class="mt16 mb16">
                  <h2 class="text-center">You have no support tickets</h2>
                </div>
              </t>
          </div>
          <div class="col-md-3"></div>
        </div>
        
    </t>
  </template>
</data>
</odoo>